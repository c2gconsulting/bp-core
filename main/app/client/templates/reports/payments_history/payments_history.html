<template name="PaymentsHistory">
  <div class="payments-history">

    <div class="container-fluid">
        <section class="row content-header z_index_99">
            <div class="container-fluid ">
                <div class="col-sm-8">
                    <h1 class="pull-left">
                        Payments History Report
                    </h1>
                </div>
                <div class="col-md-4 hidden-xs hidden-sm">
                    <ol class="breadcrumb">
                        <li><a href="{{pathFor 'home'}}"><i class="glyphicon icon-orderslist"></i>Home</a></li>
                        <li><a href="{{pathFor 'reports.home'}}">Reports</a></li>
                        <li class="active">Sales History</li>
                    </ol>
                </div>
            </div>
        </section>
        <div class="col-sm-12 sales">
            <section class="content not_margin_head">
                <div class="container-fluid bg_white">
                    <form class="">
                        <div class="row">
                            <div class="col-lg-12 bg_white ptop30 mb">
                                <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="text-muted">From</label>
                                        <div class="date">
                                            <div class="inner-addon left-addon">
                                                <i class="glyphicon icon-calendar"></i>
                                                {{#datepicker startDate }}
                                                    <input type="text" class="form-control datepicker" size="8" name="from" id="startDate" />
                                                {{/datepicker}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="text-muted">To</label>
                                        <div class="date">
                                            <div class="inner-addon left-addon">
                                                <i class="glyphicon icon-calendar"></i>
                                                {{#datepicker endDate }}
                                                    <input type="text" class="form-control datepicker" size="8" name="to" id="endDate"/>
                                                {{/datepicker}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="text-muted">Salesperson</label>
                                        <div class="date">
                                            <div class="">
                                                {{#selectpicker}}
                                                    <select class="form-control selectpicker assignee" data-live-search="true" name="selectAssignee">
                                                        <option value>Nothing Selected</option>
                                                        {{#each salesUsers}}
                                                            <option value="{{_id}}" data-icon="glyphicon-user" data-tokens="{{username}} {{userEmail}} {{profile.firstname}} {{profile.lastname}}">{{profile.fullName}}</option>
                                                        {{/each}}
                                                    </select>
                                                {{/selectpicker}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="text-muted">Customer Name</label>
                                        <div class="customer-search custom customer">
                                            <div class="inner-addon left-addon">
                                                <i class="glyphicon glyphicon-search"></i>
                                                <input type="text" class="form-control customerSearch" size="8" name="filterValue" value="{{filterConditions.customerName}}" />
                                                <div id="customerName" class="customer-search-result"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                 </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="text-muted">Sold From</label>
                                            <div class="customer-search custom location ">
                                                <div class="inner-addon left-addon">
                                                    <i class="glyphicon glyphicon-search"></i>
                                                    <input type="text" class="form-control locationSearch" size="8" name="filterValue" value="{{filterConditions.salesLocationName}}" />
                                                    <div id="divLocationSearch" class="customer-search-result"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="text-muted">Shipped From</label>
                                            <div class="customer-search custom stockLocation ">
                                                <div class="inner-addon left-addon">
                                                    <i class="glyphicon glyphicon-search"></i>
                                                    <input type="text" class="form-control stockLocationSearch" size="8" name="filterValue" value="{{filterConditions.stockLocationName}}" />
                                                    <div id="divStockLocationSearch" class="customer-search-result"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="text-muted">Order Types</label>
                                            <div class="date">
                                                <div class="">
                                                    {{#selectpicker}}
                                                        <select class="form-control selectpicker orderType" data-live-search="true">
                                                            <option value>Nothing Selected</option>
                                                            {{#each orderTypes}}
                                                                <option value="{{code}}">{{name}}</option>
                                                            {{/each}}
                                                        </select>
                                                    {{/selectpicker}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="text-muted">Created By</label>
                                            <div class="date">
                                                <div class="">
                                                    {{#selectpicker}}
                                                        <select class="form-control selectpicker createdBy" data-live-search="true" name="selectCreatedBy">
                                                            <option value>Nothing Selected</option>
                                                            {{#each salesUsers}}
                                                                <option value="{{_id}}" data-icon="glyphicon-user" data-tokens="{{username}} {{userEmail}} {{profile.firstname}} {{profile.lastname}}">{{profile.fullName}}</option>
                                                            {{/each}}
                                                        </select>
                                                    {{/selectpicker}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <p></p>
                        </div>
                    </form>
                </div>

                <div class="col-sm-12">
                    <section class="extra-margin-top-20">
                        <div class="extra-margin-bottom-10">
                            <a href="#" class="btn btn-default pull-right excel ladda-button"><span class="ladda-label"><i class="glyphicon glyphicon-download"></i> Export to CSV</span></a>
                            <a href="#" class="btn btn-default pull-right" name="reports-home"><i class="glyphicon glyphicon-signal"></i> Back to Home</a>
                            <br>
                        </div>
                        <div class="width_700 no_mobile">
                            <table class="table table-striped table-bordered table-responsive trans_history f table-hover tr_pointer">
                                <thead>
                                <tr>
                                    <td><a href="#sort" class="text-muted" data-key="orderId">Order # <small><i class="{{sortedBy 'orderId'}}"></i></small></a></td>
                                    <td><a href="#sort" class="text-muted" data-key="narration">Narration <small><i class="{{sortedBy 'narration'}}"></i></small></a></td>
                                    <td><a href="#sort" class="text-muted" data-key="reference"> Reference <small><i class="{{sortedBy 'reference'}}"></i></small></a></td>
                                    <td><a href="#sort" class="text-muted" data-key="amount"> Amount <small><i class="{{sortedBy 'amount'}}"></i></small></a></td>
                                    <td><a href="#sort" class="text-muted" data-key="customerId"> Customer <small><i class="{{sortedBy 'customerId'}}"></i></small></a></td>
                                    <td><a href="#sort" class="text-muted" data-key="postingDate">Date <small><i class="{{sortedBy 'postingDate'}}"></i></small></a></td>
                                </tr>
                                </thead>
                                <tbody>
                                {{#each payments}}
                                    <tr class="order-entry">
                                        <td><small>{{ referenceOrder }}</small></td>
                                        <td><small>
                                            {{#if narration}}
                                              {{ narration }}
                                            {{else}}
                                                None
                                            {{/if}}
                                        </small></td>
                                        <td><small>
                                            {{#if reference}}
                                                {{ reference }}
                                            {{else}}
                                                None
                                            {{/if}}
                                        </small></td>
                                        <td class="text-nowrap"><small>{{formatMoney amount currency}}</small></td>
                                        <td><small>{{#linkTo route="distributors.detail" _id=customerId}}{{referenceCustomer}}{{/linkTo}}</small></td>
                                        <td><small>{{formatTime postingDate}}</small></td>
                                    </tr>
                                {{/each}}
                                </tbody>
                            </table>
                        </div>
                        <div class="row">
                            {{#if Template.subscriptionsReady}}
                                {{#if hasMoreOrders}}
                                    <div id="showMoreResults" href="#">&nbsp;</div>
                                {{/if}}
                                {{#if hasMoreSearchResults}}
                                    <div id="showMoreResults" href="#">&nbsp;</div>
                                {{/if}}
                            {{else}}
                                <div class="col-xs-12">
                                    <div class="loading">{{> spinner}}</div>
                                </div>
                            {{/if}}
                        </div>
                    </section>

                </div>
            </section>
        </div>

    </div>

  </div>
</template>
